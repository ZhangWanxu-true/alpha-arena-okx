# 🚀 启动方式说明

## 📋 项目入口文件说明

### ⭐ 推荐：app.py（统一入口）

**适用场景**: 
- 生产环境部署
- 宝塔面板
- Docker 容器
- 长期稳定运行

**集成功能**:
- ✅ Web监控界面
- ✅ 交易机器人
- ✅ 健康监控守护
- ✅ 智能止盈止损
- ✅ 自动异常恢复

**启动命令**:
```bash
python app.py
```

---

### web_server.py（原Web服务）

**适用场景**:
- 本地开发调试
- 仅需Web界面
- 配合独立守护进程使用

**功能**:
- ✅ Web监控界面
- ✅ 交易机器人
- ❌ 无内置守护

**启动命令**:
```bash
python web_server.py
```

---

### deepseekok2.py（核心逻辑）

**适用场景**:
- 命令行运行
- 不需要Web界面
- 调试测试

**功能**:
- ✅ 交易机器人核心
- ❌ 无Web界面
- ❌ 无守护监控

**启动命令**:
```bash
python deepseekok2.py
```

---

### process_guardian.py（独立守护）

**适用场景**:
- 本地开发
- 配合web_server.py使用
- 需要独立守护进程

**功能**:
- ✅ 进程监控
- ✅ 自动重启
- ✅ 健康检查

**启动命令**:
```bash
python process_guardian.py
```

---

## 🎯 使用建议

### 生产环境（推荐）

```bash
# 使用 app.py 统一入口
python app.py
```

**优点**:
- 集成所有功能
- 自动健康监控
- 适合宝塔/Docker部署
- 开箱即用

---

### 本地开发

**方式1: 使用app.py**
```bash
python app.py
```

**方式2: 分离运行（用于调试）**
```bash
# 终端1: 启动Web服务
python web_server.py

# 终端2: 启动守护进程
python process_guardian.py
```

---

### Docker部署

**Dockerfile已配置使用app.py**:
```dockerfile
CMD ["python", "app.py"]
```

启动命令:
```bash
docker-compose up -d
```

---

### 宝塔面板部署

**入口文件**: `app.py`

在宝塔Python项目管理器中:
1. 启动文件: `app.py`
2. 运行方式: `gunicorn` 或 `python`
3. 端口: `8080`

详细教程: [宝塔面板部署指南.md](宝塔面板部署指南.md)

---

## 📊 功能对比

| 功能 | app.py | web_server.py | deepseekok2.py | process_guardian.py |
|------|--------|---------------|----------------|---------------------|
| Web界面 | ✅ | ✅ | ❌ | ❌ |
| 交易机器人 | ✅ | ✅ | ✅ | ❌ |
| 健康监控 | ✅ | ❌ | ❌ | ✅ |
| 自动重启 | ✅ | ❌ | ❌ | ✅ |
| 止盈止损 | ✅ | ✅ | ✅ | ❌ |
| 宝塔部署 | ✅ | ❌ | ❌ | ❌ |
| Docker部署 | ✅ | ⚠️ | ❌ | ❌ |

---

## 🔄 版本迁移

### 从旧版本升级

如果你之前使用 `web_server.py`:

```bash
# 旧版启动方式
python web_server.py

# 新版启动方式（推荐）
python app.py
```

**变化**:
- ✅ 功能完全兼容
- ✅ 新增内置健康监控
- ✅ 新增止盈止损
- ✅ 支持宝塔部署
- ✅ Web界面无变化

---

## 📝 启动脚本

### Windows

**start_web.bat** - 已更新使用 `app.py`:
```batch
@echo off
call venv\Scripts\activate.bat
python app.py
```

双击运行或命令行:
```bash
start_web.bat
```

---

### Linux/macOS

创建启动脚本 `start.sh`:
```bash
#!/bin/bash
source venv/bin/activate
python app.py
```

添加执行权限并运行:
```bash
chmod +x start.sh
./start.sh
```

---

## 🐛 故障排查

### 问题1: 找不到app.py

**原因**: 使用旧版本代码

**解决**: 
```bash
git pull origin main
```

---

### 问题2: 端口冲突

**现象**: `Address already in use`

**解决**:
```bash
# 修改端口
# 编辑 app.py
PORT = 8888  # 改为其他端口

# 或通过环境变量
export PORT=8888  # Linux/macOS
set PORT=8888     # Windows
```

---

### 问题3: 模块找不到

**现象**: `ModuleNotFoundError`

**解决**:
```bash
pip install -r requirements.txt
```

---

## 💡 最佳实践

### 生产环境

1. **使用app.py统一入口**
```bash
python app.py
```

2. **配合进程管理器**
```bash
# systemd (Linux)
sudo systemctl start btc-trading

# PM2 (Node.js)
pm2 start app.py --interpreter python3

# Supervisor
supervisorctl start btc-trading

# 宝塔面板
在Python项目管理器中管理
```

---

### 开发环境

1. **直接运行**
```bash
python app.py
```

2. **查看日志**
```bash
tail -f app.log
```

3. **调试模式**
```python
# 修改 app.py
app.run(host='0.0.0.0', port=8080, debug=True)
```

---

## 🎉 总结

**推荐使用 `app.py` 作为统一入口！**

✅ 功能最完整  
✅ 部署最简单  
✅ 维护最方便  
✅ 生产环境首选  

---

如有问题，请查看相关文档或提交Issue。

